# 环境初始化
## 命令行和配置文件参数解析
支持从命令行和配置文件进行参数解析，将结果保存到全局变量mapArgs、mapMultiArgs中。

util.cpp中ParseParameters支持命令行参数解析，ReadConfigFile函数支持从配置文件中解析，数据都保存到全局变量mapArgs、mapMultiArgs中。util.cpp中还包含一些如何从mapArgs、
mapMultiArgs中取数据的方法。

## 帮助及版本信息
每个模块或者说文件的默认配置都是和文件关联，没有统一存放到一个公共的默认参数文件中，为了输出完整的帮助信息, 导致添加了十多个文件。

版本信息
```
Bitcoin Core Daemon version v0.12.1.0-""
Copyright (C) 2009-2016 The Bitcoin Core Developers

This is experimental software.

Distributed under the MIT software license, see the accompanying file COPYING
or <http://www.opensource.org/licenses/mit-license.php>.

This product includes software developed by the OpenSSL Project for use in the
OpenSSL Toolkit <https://www.openssl.org/> and cryptographic software written
by Eric Young and UPnP software written by Thomas Bernard.
```

帮助信息
```
Bitcoin Core Daemon version v0.12.1.0-""

Usage:
bitcoind [options]                     Start Bitcoin Core Daemon

Options:

  -?
       This help message

  -version
       Print version and exit

  -alerts
       Receive and display P2P network alerts (default: 0)

  -alertnotify=<cmd>
       Execute command when a relevant alert is received or we see a really
       long fork (%s in cmd is replaced by message)

  -blocknotify=<cmd>
       Execute command when the best block changes (%s in cmd is replaced by
       block hash)

  -checkblocks=<n>
       How many blocks to check at startup (default: 288, 0 = all)

  -checklevel=<n>
       How thorough the block verification of -checkblocks is (0-4, default: 3)

  -conf=<file>
       Specify configuration file (default: bitcoin.conf)

  -daemon
       Run in the background as a daemon and accept commands

  -datadir=<dir>
       Specify data directory

  -dbcache=<n>
       Set database cache size in megabytes (4 to 16384, default: 100)

  -loadblock=<file>
       Imports blocks from external blk000??.dat file on startup

  -maxorphantx=<n>
       Keep at most <n> unconnectable transactions in memory (default: 100)

  -maxmempool=<n>
       Keep the transaction memory pool below <n> megabytes (default: 300)

  -mempoolexpiry=<n>
       Do not keep transactions in the mempool longer than <n> hours (default:
       72)

  -par=<n>
       Set the number of script verification threads (-2 to 16, 0 = auto, <0 =
       leave that many cores free, default: 0)

  -pid=<file>
       Specify pid file (default: bitcoind.pid)

  -prune=<n>
       Reduce storage requirements by pruning (deleting) old blocks. This mode
       is incompatible with -txindex and -rescan. Warning: Reverting this
       setting requires re-downloading the entire blockchain. (default: 0 =
       disable pruning blocks, >550 = target size in MiB to use for block
       files)

  -reindex
       Rebuild block chain index from current blk000??.dat files on startup

  -sysperms
       Create new files with system default permissions, instead of umask 077
       (only effective with disabled wallet functionality)

  -txindex
       Maintain a full transaction index, used by the getrawtransaction rpc
       call (default: 0)

Connection options:

  -addnode=<ip>
       Add a node to connect to and attempt to keep the connection open

  -banscore=<n>
       Threshold for disconnecting misbehaving peers (default: 100)

  -bantime=<n>
       Number of seconds to keep misbehaving peers from reconnecting (default:
       86400)

  -bind=<addr>
       Bind to given address and always listen on it. Use [host]:port notation
       for IPv6

  -connect=<ip>
       Connect only to the specified node(s)

  -discover
       Discover own IP addresses (default: 1 when listening and no -externalip
       or -proxy)

  -dns
       Allow DNS lookups for -addnode, -seednode and -connect (default: 1)

  -dnsseed
       Query for peer addresses via DNS lookup, if low on addresses (default: 1
       unless -connect)

  -externalip=<ip>
       Specify your own public address

  -forcednsseed
       Always query for peer addresses via DNS lookup (default: 0)

  -listen
       Accept connections from outside (default: 1 if no -proxy or -connect)

  -listenonion
       Automatically create Tor hidden service (default: 1)

  -maxconnections=<n>
       Maintain at most <n> connections to peers (default: 125)

  -maxreceivebuffer=<n>
       Maximum per-connection receive buffer, <n>*1000 bytes (default: 5000)

  -maxsendbuffer=<n>
       Maximum per-connection send buffer, <n>*1000 bytes (default: 1000)

  -onion=<ip:port>
       Use separate SOCKS5 proxy to reach peers via Tor hidden services
       (default: -proxy)

  -onlynet=<net>
       Only connect to nodes in network <net> (ipv4, ipv6 or onion)

  -permitbaremultisig
       Relay non-P2SH multisig (default: 1)

  -peerbloomfilters
       Support filtering of blocks and transaction with bloom filters (default:
       1)

  -port=<port>
       Listen for connections on <port> (default: 8333 or testnet: 18333)

  -proxy=<ip:port>
       Connect through SOCKS5 proxy

  -proxyrandomize
       Randomize credentials for every proxy connection. This enables Tor
       stream isolation (default: 1)

  -seednode=<ip>
       Connect to a node to retrieve peer addresses, and disconnect

  -timeout=<n>
       Specify connection timeout in milliseconds (minimum: 1, default: 5000)

  -torcontrol=<ip>:<port>
       Tor control port to use if onion listening enabled (default:
       127.0.0.1:9051)

  -torpassword=<pass>
       Tor control port password (default: empty)

  -whitebind=<addr>
       Bind to given address and whitelist peers connecting to it. Use
       [host]:port notation for IPv6

  -whitelist=<netmask>
       Whitelist peers connecting from the given netmask or IP address. Can be
       specified multiple times. Whitelisted peers cannot be DoS banned and
       their transactions are always relayed, even if they are already in the
       mempool, useful e.g. for a gateway

  -whitelistrelay
       Accept relayed transactions received from whitelisted peers even when
       not relaying transactions (default: 1)

  -whitelistforcerelay
       Force relay of transactions from whitelisted peers even they violate
       local relay policy (default: 1)

  -maxuploadtarget=<n>
       Tries to keep outbound traffic under the given target (in MiB per 24h),
       0 = no limit (default: 0)

Debugging/Testing options:

  -uacomment=<cmt>
       Append comment to the user agent string

  -debug=<category>
       Output debugging information (default: 0, supplying <category> is
       optional). If <category> is not supplied or if <category> = 1, output
       all debugging information.<category> can be: addrman, alert, bench,
       coindb, db, lock, rand, rpc, selectcoins, mempool, mempoolrej, net,
       proxy, prune, http, libevent, tor, zmq.

  -gen
       Generate coins (default: 0)

  -genproclimit=<n>
       Set the number of threads for coin generation if enabled (-1 = all
       cores, default: 1)

  -help-debug
       Show all debugging options (usage: --help -help-debug)

  -logips
       Include IP addresses in debug output (default: 0)

  -logtimestamps
       Prepend debug output with timestamp (default: 1)

  -minrelaytxfee=<amt>
       Fees (in BTC/kB) smaller than this are considered zero fee for relaying,
       mining and transaction creation (default: 0.00001)

  -printtoconsole
       Send trace/debug info to console instead of debug.log file

  -shrinkdebugfile
       Shrink debug.log file on client startup (default: 1 when no -debug)

Chain selection options:

  -testnet
       Use the test chain

Node relay options:

  -bytespersigop
       Minimum bytes per sigop in transactions we relay and mine (default: 20)

  -datacarrier
       Relay and mine data carrier transactions (default: 1)

  -datacarriersize
       Maximum size of data in data carrier transactions we relay and mine
       (default: 83)

  -mempoolreplacement
       Enable transaction replacement in the memory pool (default: 1)

Block creation options:

  -blockminsize=<n>
       Set minimum block size in bytes (default: 0)

  -blockmaxsize=<n>
       Set maximum block size in bytes (default: 750000)

  -blockprioritysize=<n>
       Set maximum size of high-priority/low-fee transactions in bytes
       (default: 0)

RPC server options:

  -server
       Accept command line and JSON-RPC commands

  -rest
       Accept public REST requests (default: 0)

  -rpcbind=<addr>
       Bind to given address to listen for JSON-RPC connections. Use
       [host]:port notation for IPv6. This option can be specified multiple
       times (default: bind to all interfaces)

  -rpccookiefile=<loc>
       Location of the auth cookie (default: data dir)

  -rpcuser=<user>
       Username for JSON-RPC connections

  -rpcpassword=<pw>
       Password for JSON-RPC connections

  -rpcauth=<userpw>
       Username and hashed password for JSON-RPC connections. The field
       <userpw> comes in the format: <USERNAME>:<SALT>$<HASH>. A canonical
       python script is included in share/rpcuser. This option can be specified
       multiple times

  -rpcport=<port>
       Listen for JSON-RPC connections on <port> (default: 8332 or testnet:
       18332)

  -rpcallowip=<ip>
       Allow JSON-RPC connections from specified source. Valid for <ip> are a
       single IP (e.g. 1.2.3.4), a network/netmask (e.g. 1.2.3.4/255.255.255.0)
       or a network/CIDR (e.g. 1.2.3.4/24). This option can be specified
       multiple times

  -rpcthreads=<n>
       Set the number of threads to service RPC calls (default: 4)
```

## 代码说明
### 文件
说明这个文件目前的功能，后续随着代码的深入随时补充。
├── CMakeLists.txt                        构建文件
├── amount.cpp                            
├── amount.h                              定义CAmount
├── bitcoind.cpp                          bitcoind主函数，main入口
├── chainparams.cpp                       继承CChainParams，实现了主链、测试链、回归测试链。配置不同的链参数
├── chainparams.h                         定义了CChainParams，链的公共参数。
├── chainparamsbase.cpp                   从实现看也是定义了链相关的参数，没弄明白为什么要搞两套☆
├── chainparamsbase.h         
├── clientversion.cpp                     版本相关信息，为了实现方便。没有配置在cmake中
├── clientversion.h
├── consensus
│   └── consensus.h                       为了支持help信息，引入相关default参数
├── httpserver.h                          为了支持help信息，引入相关default参数
├── init.cpp                              实现版本、帮助信息
├── init.h
├── main.h                                为了支持help信息，引入相关default参数
├── miner.h                               为了支持help信息，引入相关default参数
├── net.h                                 为了支持help信息，引入相关default参数
├── netbase.h                             为了支持help信息，引入相关default参数
├── noui.cpp                              定义了ui_interface.h中信号对应的槽
├── noui.h
├── policy
│   └── policy.h                          为了支持help信息，引入相关default参数
├── script
│   ├── sigcache.h                        为了支持help信息，引入相关default参数
│   └── standard.h                        为了支持help信息，引入相关default参数
├── tinyformat.h                          第三方库，定义strprintf函数，进行string格式化
├── torcontrol.cpp                        为了支持help信息，引入相关default参数
├── torcontrol.h
├── txdb.h                                为了支持help信息，引入相关default参数
├── ui_interface.h                        定义了相关信号量（boost信号槽）
├── util.cpp                              支持从命令行或文件解析参数到全局变量，mapArgs、mapMultiArgs。并包含从中获取参数值的方法。
├── util.h
├── utilmoneystr.cpp                      为了支持help信息，引入相关default参数
├── utilmoneystr.h
├── utilstrencodings.cpp                  atoi系列函数，格式化字符串根据固定的width
└── utilstrencodings.h

### 类
CChainParams
├── CMainParams
├── CTestNetParams
└── CRegTestParams

CBaseChainParams
├── CBaseMainParams
├── CBaseTestNetParams
└── CBaseRegTestParams

CClientUIInterface

## 参考链接：
boost 官方文档
http://www.boost.org/doc/libs/1_66_0/

boost 文件操作
http://zh.highscore.de/cpp/boost/filesystem.html

boost 命令行参数和配置文件解析
https://blog.csdn.net/yahohi/article/details/9790921

git tag分支
https://www.cnblogs.com/x3d/p/git-tag.html
